# SensoryFlow 需求规格说明书

## 1. 概述
SensoryFlow 是一款 Chrome 浏览器插件，通过应用沉浸式滤镜和交互特效，根据网页内容和“情绪”改变网页的视觉体验。其目标是通过自动化的模式切换和高性能的视觉覆盖层，将枯燥的网页浏览转化为一场感官之旅。

## 2. 用户故事
- **模式切换**：作为一名用户，我希望浏览器氛围能根据我访问的网站自动改变（例如 GitHub 与 博客），以便我的视觉环境与内容情绪相匹配。
- **自定义调节**：作为一名用户，我希望通过弹出面板调整视觉效果的强度，以便在沉浸感和可读性之间取得平衡。
- **性能表现**：作为一名用户，我希望视觉效果流畅（60FPS）且不拖慢原网页的速度，以确保浏览体验依然顺滑。
- **隔离性**：作为一名用户，我希望插件的视觉覆盖层不会破坏我访问的网站的布局或样式，确保网站功能正常。

## 3. 功能需求 (EARS)

### 3.1 感官引擎 (检测)
- **普遍性**：SensoryFlow 引擎应扫描每个加载页面的 `document.title`、`meta[description]` 和 URL。
- **事件驱动**：当页面匹配“编程”特征（如域名为 github.com）时，系统应激活 **极客 (Coding)** 模式。
- **事件驱动**：当页面匹配“文章/博客”特征（如包含 `<article>` 标签）时，系统应激活 **悦读 (Reading)** 模式。
- **事件驱动**：当页面匹配“灵感/设计”特征（如域名为 behance.net 或 pinterest.com）时，系统应激活 **灵感 (Creative)** 模式。

### 3.2 视觉层 (渲染)
- **普遍性**：系统应将所有视觉覆盖元素（Canvas/SVG）注入到 **Shadow DOM** 中，以防止 CSS 样式污染。
- **状态驱动**：在 **极客** 模式下，系统应在滚动期间应用故障滤镜（Glitch Filter）和动态模糊。
- **状态驱动**：在 **悦读** 模式下，系统应应用柔和的纸张纹理和暖色调矩阵滤镜。
- **状态驱动**：在 **灵感** 模式下，系统应启用流体渐变背景和点击时的波纹效果。
- **非预期行为**：如果用户的设备性能（FPS）掉到 30 以下，系统应减少粒子效果密度或禁用复杂的 SVG 滤镜。

### 3.3 控制层 (控制面板)
- **普遍性**：系统应提供一个具有玻璃拟态风格的弹出 UI。
- **事件驱动**：当用户在弹出窗口中调整强度滑块时，系统应通过 `chrome.runtime.sendMessage` 将新参数广播到所有活动标签页。

## 4. 非功能性需求
- **性能**：视觉覆盖层必须使用 GPU 加速（`will-change`）并以 60FPS 为目标。
- **延迟**：模式切换和参数更新必须在触发事件后的 100ms 内发生。
- **兼容性**：插件必须支持 Chrome Manifest V3。
- **稳定性**：插件不得向宿主页面的全局 CSS 作用域注入样式。

## 5. 验收标准
- [ ] 根据 URL/Meta 自动识别至少 3 种不同模式（悦读、极客、灵感）。
- [ ] 成功使用 Shadow DOM 注入视觉层，且不影响页面布局。
- [ ] 弹出窗口设置实时同步到所有 Content Script。
- [ ] 在中端笔记本上进行活跃交互（滚动/移动）时保持 >50FPS。
- [ ] 当性能未达标时，平滑降级到基础滤镜。
